{"version":3,"file":"onion.module.js","sources":["../src/onion.ts"],"sourcesContent":["interface OnionElement extends HTMLElement {\n  onion?: {\n    abort: () => void;\n  }\n}\n\ninterface ClassList {\n  [key: string]: boolean;\n}\n\nfunction setClasses(el: Element, classes: ClassList) {\n  Object.entries(classes).forEach(([key, value]) => el.classList.toggle(key, value));\n}\n\nfunction addEndListener(el: Element, listener: () => void) {\n  el.addEventListener(\"transitionend\", listener);\n  el.addEventListener(\"animationend\", listener);\n}\n\nfunction removeEndListener(el: Element, listener: () => void) {\n  el.removeEventListener(\"transitionend\", listener);\n  el.removeEventListener(\"animationend\", listener);\n}\n\nexport function show(el: OnionElement) {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-open\") && !el.classList.contains(\"is-closing\"))\n    return;\n\n  el.onion?.abort();\n\n  const handleEnd = () => {\n    setClasses(el, {\n      'is-open': true,\n      'is-closed': false,\n      'is-opening': false,\n      'is-closing': false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    'is-open': false,\n    'is-closed': false,\n    'is-opening': false,\n    'is-closing': false,\n  });\n\n  setTimeout(() => {\n    setClasses(el, {\n      'is-open': true,\n      'is-closed': false,\n      'is-opening': true,\n      'is-closing': false,\n    });\n  });\n}\n\nexport function hide(el: OnionElement) {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-closed\"))\n    return;\n\n  el.onion?.abort();\n\n  const handleEnd = () => {\n    setClasses(el, {\n      'is-open': false,\n      'is-closed': true,\n      'is-opening': false,\n      'is-closing': false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    'is-open': true,\n    'is-closed': false,\n    'is-opening': false,\n    'is-closing': true,\n  });\n}\n\nexport function toggle(el: OnionElement, force?: boolean) {\n  if (!(el instanceof HTMLElement)) return;\n\n  el.onion?.abort();\n\n  if (typeof force === 'undefined') {\n    if (el.classList.contains('is-open') && !el.classList.contains(\"is-closing\")) {\n      hide(el);\n    } else {\n      show(el);\n    }\n  } else {\n    if (force) show(el);\n    else hide(el);\n  }\n}\n"],"names":["setClasses","el","classes","Object","entries","forEach","key","classList","toggle","value","addEndListener","listener","addEventListener","removeEndListener","removeEventListener","show","HTMLElement","contains","onion","_el$onion","abort","handleEnd","_el$onion2","timeoutID","setTimeout","clearTimeout","_el$onion3","_el$onion4","force","_el$onion5","hide"],"mappings":"AAUA,SAASA,EAAWC,EAAaC,GAC/BC,OAAOC,QAAQF,GAASG,QAAQ,SAAEC,UAAkBL,EAACM,UAAUC,OAAxBC,EAAAA,QAAP,EACjC,CAED,SAAAC,EAAwBT,EAAaU,GACnCV,EAAGW,iBAAiB,gBAAiBD,GACrCV,EAAGW,iBAAiB,eAAgBD,EACrC,CAED,SAAAE,EAA2BZ,EAAaU,GACtCV,EAAGa,oBAAoB,gBAAiBH,GACxCV,EAAGa,oBAAoB,eAAgBH,EACxC,CAEK,SAAAI,EAAed,SACnB,GAAMA,aAAFe,eAEAf,EAAGM,UAAUU,SAAS,YAAehB,EAAGM,UAAUU,SAAS,eAA/D,CAGA,SAAAhB,EAAGiB,QAAHC,EAAUC,QAEV,IAAeC,EAAG,WAAK,IAAAC,EACrBtB,EAAWC,EAAI,CACb,WAAW,EACX,aAAa,EACb,cAAc,EACd,cAAc,IAEhB,OAAAA,EAAAA,EAAGiB,QAAHI,EAAUF,OACX,EAEKG,EAAYC,WAAWH,EAAW,KAExCpB,EAAGiB,MAAQ,CACTE,MAAO,WACLP,EAAkBZ,EAAIoB,GACtBI,aAAaF,EACd,GAGHb,EAAeT,EAAIoB,GAEnBrB,EAAWC,EAAI,CACb,WAAW,EACX,aAAa,EACb,cAAc,EACd,cAAc,IAGhBuB,WAAW,WACTxB,EAAWC,EAAI,CACb,WAAW,EACX,aAAa,EACb,cAAc,EACd,cAAc,GAEjB,EAvCC,CAwCH,CAEK,WAAeA,GAAgB,IAAAyB,EACnC,GAAMzB,aAAce,cAEhBf,EAAGM,UAAUU,SAAS,aAA1B,QAGAhB,EAAAA,EAAGiB,UAAOE,QAEV,IAAMC,EAAY,WAAK,IAAAM,EACrB3B,EAAWC,EAAI,CACb,WAAW,EACX,aAAa,EACb,cAAc,EACd,cAAc,IAENmB,OAAVnB,EAAAA,EAAGiB,QAAOE,EAAAA,OACX,EAEKG,EAAYC,WAAWH,EAAW,KAExCpB,EAAGiB,MAAQ,CACTE,MAAO,WACLP,EAAkBZ,EAAIoB,GACtBI,aAAaF,EACd,GAGHb,EAAeT,EAAIoB,GAEnBrB,EAAWC,EAAI,CACb,WAAW,EACX,aAAa,EACb,cAAc,EACd,cAAc,GA3BhB,CA6BD,CAEe,WAAOA,EAAkB2B,GAAe,IAAAC,EAChD5B,aAAce,cAEpB,OAAAa,EAAA5B,EAAGiB,QAAHW,EAAUT,aAEW,IAAVQ,EACL3B,EAAGM,UAAUU,SAAS,aAAehB,EAAGM,UAAUU,SAAS,cAC7Da,EAAK7B,GAELc,EAAKd,GAGH2B,EAAOb,EAAKd,GACP6B,EAAC7B,GAEb"}