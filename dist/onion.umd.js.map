{"version":3,"file":"onion.umd.js","sources":["../src/onion.ts"],"sourcesContent":["interface OnionElement extends HTMLElement {\n  onion?: {\n    abort: () => void;\n  }\n}\n\ninterface ClassList {\n  [key: string]: boolean;\n}\n\nfunction setClasses(el: Element, classes: ClassList) {\n  Object.entries(classes)\n    .filter(([key]) => key.length)\n    .forEach(([key, value]) => el.classList.toggle(key, value));\n}\n\nfunction addEndListener(el: Element, listener: () => void) {\n  el.addEventListener(\"transitionend\", listener);\n  el.addEventListener(\"animationend\", listener);\n}\n\nfunction removeEndListener(el: Element, listener: () => void) {\n  el.removeEventListener(\"transitionend\", listener);\n  el.removeEventListener(\"animationend\", listener);\n}\n\nfunction show(el: OnionElement, token: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-opening\"))\n    return;\n\n  el.onion?.abort();\n\n  if (token === \"is-opening\")\n    token = \"\";\n\n  const handleEnd = (event?: Event) => {\n    if (event?.target !== el) return;\n\n    setClasses(el, {\n      \"is-open\": true,\n      \"is-opening\": true,\n      \"is-closing\": false,\n      [token]: false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n      setClasses(el, { [token]: false });\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": false,\n    \"is-closing\": false,\n    [token]: false,\n  });\n\n  setTimeout(() => setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": true,\n    \"is-closing\": false,\n    [token]: true,\n  }));\n}\n\nfunction hide(el: OnionElement, token: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-closing\") || !el.classList.contains(\"is-open\"))\n    return;\n\n  el.onion?.abort();\n\n  if (token === \"is-closing\")\n    token = \"\";\n\n  const handleEnd = (event?: Event) => {\n    if (event?.target !== el) return;\n\n    setClasses(el, {\n      \"is-open\": false,\n      \"is-opening\": false,\n      \"is-closing\": false,\n      [token]: false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n      setClasses(el, { [token]: false });\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": false,\n    \"is-closing\": true,\n    [token]: true,\n  });\n}\n\nfunction toggle(el: OnionElement, force?: boolean, openingToken: string = \"\", closingToken: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (typeof force === 'undefined') {\n    if (el.classList.contains('is-opening')) {\n      hide(el, closingToken);\n    } else {\n      show(el, openingToken);\n    }\n  } else {\n    if (force) show(el, openingToken);\n    else hide(el, closingToken);\n  }\n}\n\nexport default {\n  show,\n  hide,\n  toggle\n};\n"],"names":["setClasses","el","classes","Object","entries","filter","key","length","forEach","classList","toggle","value","addEndListener","listener","addEventListener","removeEndListener","removeEventListener","show","token","HTMLElement","contains","abort","onion","handleEnd","event","_setClasses","_el$onion2","target","timeoutID","setTimeout","_setClasses2","clearTimeout","_setClasses3","_setClasses4","hide","_el$onion3","_setClasses5","_el$onion4","_setClasses6","_setClasses7","force","openingToken","closingToken"],"mappings":"wNAUA,SAAAA,EAAoBC,EAAaC,GAC/BC,OAAOC,QAAQF,GACZG,OAAO,SAAEC,GAASA,OAAAA,EAAAA,GAAIC,MAAf,GACPC,QAAQ,SAAEF,UAAkBL,EAACQ,UAAUC,OAAxBC,EAAAA,QAAP,EACZ,CAED,SAAAC,EAAwBX,EAAaY,GACnCZ,EAAGa,iBAAiB,gBAAiBD,GACrCZ,EAAGa,iBAAiB,eAAgBD,EACrC,CAED,SAAAE,EAA2Bd,EAAaY,GACtCZ,EAAGe,oBAAoB,gBAAiBH,GACxCZ,EAAGe,oBAAoB,eAAgBH,EACxC,CAED,SAASI,EAAKhB,EAAkBiB,GAAAA,IAAAA,EAAAA,EAC9B,QAD8BA,IAAAA,IAAAA,EAAgB,IACxCjB,aAAckB,cAEhBlB,EAAGQ,UAAUW,SAAS,cAA1B,CAGUC,OAAVpB,EAAAA,EAAGqB,QAAOD,EAAAA,QAEI,eAAVH,IACFA,EAAQ,IAEV,IAAeK,EAAG,SAACC,GAAiB,IAAAC,EAAAC,GAC9B,MAAAF,OAAA,EAAAA,EAAOG,UAAW1B,IAEtBD,EAAWC,IAADwB,EAAA,CACR,WAAW,EACX,cAAc,EACd,cAAc,IACbP,IAAQ,EAJDO,IAMV,OAAAC,EAAAzB,EAAGqB,QAAHI,EAAUL,QACX,EAEcO,EAAGC,WAAWN,EAAW,KAExCtB,EAAGqB,MAAQ,CACTD,MAAO,WAAK,IAAAS,EACVf,EAAkBd,EAAIsB,GACtBQ,aAAaH,GACb5B,EAAWC,IAAOiB,EAAAA,CAAAA,GAAAA,IAAQ,EAC3BY,GAAA,GAGHlB,EAAeX,EAAIsB,GAEnBvB,EAAWC,IACT+B,EAAA,CAAA,WAAW,EACX,cAAc,EACd,cAAc,IACbd,IAAQ,EAJDc,IAOVH,WAAW,WAAM7B,IAAAA,EAAAA,OAAAA,EAAWC,IAC1BgC,EAAA,CAAA,WAAW,EACX,cAAc,EACd,cAAc,IACbf,IAAQ,EAJgBe,GAAhB,EAtCT,CA4CH,CAED,SAAAC,EAAcjC,EAAkBiB,GAAAA,IAAAA,EAAAA,EAC9B,QAD8BA,IAAAA,IAAAA,EAAgB,IACxCjB,aAAFkB,cAEAlB,EAAGQ,UAAUW,SAAS,eAAkBnB,EAAGQ,UAAUW,SAAS,WAAlE,CAGUC,OAAVc,EAAAlC,EAAGqB,QAAOD,EAAAA,QAEI,eAAVH,IACFA,EAAQ,IAEV,IAAeK,EAAG,SAACC,GACjB,IAAAY,EAAAC,GAAI,MAAAb,OAAA,EAAAA,EAAOG,UAAW1B,IAEtBD,EAAWC,IAADmC,EAAA,CACR,WAAW,EACX,cAAc,EACd,cAAc,IACblB,IAAQ,EAJDkB,IAMAf,OAAVgB,EAAApC,EAAGqB,QAAOD,EAAAA,QACX,EAEcO,EAAGC,WAAWN,EAAW,KAExCtB,EAAGqB,MAAQ,CACTD,MAAO,iBACLN,EAAkBd,EAAIsB,GACtBQ,aAAaH,GACb5B,EAAWC,IAAOiB,EAAAA,CAAAA,GAAAA,IAAQ,EAC3BoB,GAAA,GAGH1B,EAAeX,EAAIsB,GAEnBvB,EAAWC,IAADsC,EAAA,CACR,WAAW,EACX,cAAc,EACd,cAAc,IACbrB,IAAQ,EAEZqB,GAnCC,CAmCD,OAiBc,CACbtB,KAAAA,EACAiB,KAAAA,EACAxB,OAlBF,SAAgBT,EAAkBuC,EAAiBC,EAA2BC,QAA3BD,IAAAA,IAAAA,EAAuB,SAAIC,IAAAA,IAAAA,EAAuB,IAC7FzC,aAAFkB,mBAEiB,IAAVqB,EACLvC,EAAGQ,UAAUW,SAAS,cACxBc,EAAKjC,EAAIyC,GAETzB,EAAKhB,EAAIwC,GAGPD,EAAOvB,EAAKhB,EAAIwC,GACXP,EAACjC,EAAIyC,GAEjB"}