{"version":3,"file":"onion.umd.js","sources":["../src/onion.ts"],"sourcesContent":["interface OnionElement extends HTMLElement {\n  onion?: {\n    abort: () => void;\n  }\n}\n\ninterface ClassList {\n  [key: string]: boolean;\n}\n\nfunction setClasses(el: Element, classes: ClassList) {\n  Object.entries(classes)\n    .filter(([key]) => key.length)\n    .forEach(([key, value]) => el.classList.toggle(key, value));\n}\n\nfunction addEndListener(el: Element, listener: () => void) {\n  el.addEventListener(\"transitionend\", listener);\n  el.addEventListener(\"animationend\", listener);\n}\n\nfunction removeEndListener(el: Element, listener: () => void) {\n  el.removeEventListener(\"transitionend\", listener);\n  el.removeEventListener(\"animationend\", listener);\n}\n\nfunction show(el: OnionElement, token: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-opening\"))\n    return;\n\n  el.onion?.abort();\n\n  if (token === \"is-opening\")\n    token = \"\";\n\n  const handleEnd = () => {\n    setClasses(el, {\n      \"is-open\": true,\n      \"is-opening\": true,\n      \"is-closing\": false,\n      [token]: false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n      setClasses(el, { [token]: false });\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": false,\n    \"is-closing\": false,\n    [token]: false,\n  });\n\n  setTimeout(() => setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": true,\n    \"is-closing\": false,\n    [token]: true,\n  }));\n}\n\nfunction hide(el: OnionElement, token: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-closing\") || !el.classList.contains(\"is-open\"))\n    return;\n\n  el.onion?.abort();\n\n  if (token === \"is-closing\")\n    token = \"\";\n\n  const handleEnd = () => {\n    setClasses(el, {\n      \"is-open\": false,\n      \"is-opening\": false,\n      \"is-closing\": false,\n      [token]: false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n      setClasses(el, { [token]: false });\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": false,\n    \"is-closing\": true,\n    [token]: true,\n  });\n}\n\nfunction toggle(el: OnionElement, force?: boolean, openingToken: string = \"\", closingToken: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (typeof force === 'undefined') {\n    if (el.classList.contains('is-opening')) {\n      hide(el, closingToken);\n    } else {\n      show(el, openingToken);\n    }\n  } else {\n    if (force) show(el, openingToken);\n    else hide(el, closingToken);\n  }\n}\n\nexport default {\n  show,\n  hide,\n  toggle\n};\n"],"names":["setClasses","el","classes","Object","entries","filter","_ref","length","forEach","_ref2","classList","toggle","addEndListener","listener","addEventListener","removeEndListener","removeEventListener","token","_el$onion","_setClasses3","HTMLElement","contains","abort","onion","handleEnd","_setClasses","timeoutID","setTimeout","clearTimeout","_setClasses2","_setClasses4","hide","_setClasses5","_el$onion4","_setClasses6","_setClasses7","show","force","openingToken","closingToken"],"mappings":"wNAUA,SAAAA,EAAoBC,EAAaC,GAC/BC,OAAOC,QAAQF,GACZG,OAAO,SAAAC,GAAA,OAAAA,EAAA,GAAeC,MAAf,GACPC,QAAQ,SAAAC,GAAkBR,OAAAA,EAAGS,UAAUC,OAA/BF,EAAA,GAAkBR,EAAAA,GAAlB,EACZ,CAED,SAASW,EAAeX,EAAaY,GACnCZ,EAAGa,iBAAiB,gBAAiBD,GACrCZ,EAAGa,iBAAiB,eAAgBD,EACrC,CAED,SAASE,EAAkBd,EAAaY,GACtCZ,EAAGe,oBAAoB,gBAAiBH,GACxCZ,EAAGe,oBAAoB,eAAgBH,EACxC,CAED,WAAcZ,EAAkBgB,GAAkB,IAAAC,EAAAC,EAChD,QADgD,IAAlBF,IAAAA,EAAgB,IACxChB,aAAFmB,cAEAnB,EAAGS,UAAUW,SAAS,cAA1B,CAGUC,OAAVJ,EAAAjB,EAAGsB,QAAOD,EAAAA,QAEI,eAAVL,IACFA,EAAQ,IAEV,IAAMO,EAAY,WAChBxB,IAAAA,EAAAA,EAAAA,EAAWC,IACTwB,EAAA,CAAA,WAAW,EACX,cAAc,EACd,cAAc,IACbR,IAAQ,EAJXQ,IAMUH,OAAVrB,EAAAA,EAAGsB,QAAOD,EAAAA,OACX,EAEcI,EAAGC,WAAWH,EAAW,KAExCvB,EAAGsB,MAAQ,CACTD,MAAO,WACLP,IAAAA,EAAAA,EAAkBd,EAAIuB,GACtBI,aAAaF,GACb1B,EAAWC,IAAOgB,EAAAA,CAAAA,GAAAA,IAAQ,EAC3BY,GAAA,GAGHjB,EAAeX,EAAIuB,GAEnBxB,EAAWC,IAADkB,EAAA,CACR,WAAW,EACX,cAAc,EACd,cAAc,IACbF,IAAQ,EAJXE,IAOAQ,WAAW,WAAA,IAAAG,EAAA,OAAgB9B,EAACC,IAAD6B,EAAA,CACzB,WAAW,EACX,cAAc,EACd,cAAc,IACbb,IAAQ,EAJgBa,GAAhB,EApCT,CA0CH,CAED,SAAAC,EAAc9B,EAAkBgB,GAAAA,IAAAA,EAAAA,EAC9B,QAD8BA,IAAAA,IAAAA,EAAgB,IACxChB,aAAcmB,cAEhBnB,EAAGS,UAAUW,SAAS,eAAkBpB,EAAGS,UAAUW,SAAS,WAAlE,CAGUC,OAAVrB,EAAAA,EAAGsB,QAAOD,EAAAA,QAEI,eAAVL,IACFA,EAAQ,IAEV,IAAMO,EAAY,WAAK,IAAAQ,EAAAC,EACrBjC,EAAWC,IAAD+B,EAAA,CACR,WAAW,EACX,cAAc,EACd,cAAc,IACbf,IAAQ,EAJXe,IAMUV,OAAVrB,EAAAA,EAAGsB,QAAOD,EAAAA,OACX,IAEiBK,WAAWH,EAAW,KAExCvB,EAAGsB,MAAQ,CACTD,MAAO,WACLP,IAAAA,EAAAA,EAAkBd,EAAIuB,GACtBI,aAAaF,GACb1B,EAAWC,UAAOgB,IAAQ,EAAhBiB,GACX,GAGHtB,EAAeX,EAAIuB,GAEnBxB,EAAWC,IAADkC,EAAA,CACR,WAAW,EACX,cAAc,EACd,cAAc,IACblB,IAAQ,EAEZkB,IAAA,OAiBc,CACbC,KAAAA,EACAL,KAAAA,EACApB,OAlBF,SAAgBV,EAAkBoC,EAAiBC,EAA2BC,QAA3BD,IAAAA,IAAAA,EAAuB,SAAIC,IAAAA,IAAAA,EAAuB,IAC7FtC,aAAcmB,mBAEC,IAAjBiB,EACEpC,EAAGS,UAAUW,SAAS,cACxBU,EAAK9B,EAAIsC,GAETH,EAAKnC,EAAIqC,GAGPD,EAAOD,EAAKnC,EAAIqC,GACfP,EAAK9B,EAAIsC,GAEjB"}