{"version":3,"file":"onion.modern.js","sources":["../src/onion.ts"],"sourcesContent":["interface OnionElement extends HTMLElement {\n  onion?: {\n    abort: () => void;\n  }\n}\n\ninterface ClassList {\n  [key: string]: boolean;\n}\n\nfunction setClasses(el: Element, classes: ClassList) {\n  Object.entries(classes)\n    .filter(([key]) => key.length)\n    .forEach(([key, value]) => el.classList.toggle(key, value));\n}\n\nfunction addEndListener(el: Element, listener: () => void) {\n  el.addEventListener(\"transitionend\", listener);\n  el.addEventListener(\"animationend\", listener);\n}\n\nfunction removeEndListener(el: Element, listener: () => void) {\n  el.removeEventListener(\"transitionend\", listener);\n  el.removeEventListener(\"animationend\", listener);\n}\n\nfunction show(el: OnionElement, token: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-opening\"))\n    return;\n\n  el.onion?.abort();\n\n  if (token === \"is-opening\")\n    token = \"\";\n\n  const handleEnd = (event?: Event) => {\n    if (event?.target !== el) return;\n\n    setClasses(el, {\n      \"is-open\": true,\n      \"is-opening\": true,\n      \"is-closing\": false,\n      [token]: false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n      setClasses(el, { [token]: false });\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": false,\n    \"is-closing\": false,\n    [token]: false,\n  });\n\n  setTimeout(() => setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": true,\n    \"is-closing\": false,\n    [token]: true,\n  }));\n}\n\nfunction hide(el: OnionElement, token: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-closing\") || !el.classList.contains(\"is-open\"))\n    return;\n\n  el.onion?.abort();\n\n  if (token === \"is-closing\")\n    token = \"\";\n\n  const handleEnd = (event?: Event) => {\n    if (event?.target !== el) return;\n\n    setClasses(el, {\n      \"is-open\": false,\n      \"is-opening\": false,\n      \"is-closing\": false,\n      [token]: false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n      setClasses(el, { [token]: false });\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": false,\n    \"is-closing\": true,\n    [token]: true,\n  });\n}\n\nfunction toggle(el: OnionElement, force?: boolean, openingToken: string = \"\", closingToken: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (typeof force === 'undefined') {\n    if (el.classList.contains('is-opening')) {\n      hide(el, closingToken);\n    } else {\n      show(el, openingToken);\n    }\n  } else {\n    if (force) show(el, openingToken);\n    else hide(el, closingToken);\n  }\n}\n\nexport default {\n  show,\n  hide,\n  toggle\n};\n"],"names":["setClasses","el","classes","Object","entries","filter","key","length","forEach","value","classList","toggle","listener","addEventListener","removeEndListener","removeEventListener","show","token","_el$onion","HTMLElement","contains","onion","abort","handleEnd","event","_el$onion2","target","timeoutID","setTimeout","clearTimeout","addEndListener","hide","_el$onion3","_el$onion4","force","openingToken","closingToken"],"mappings":"AAUA,SAAAA,EAAoBC,EAAaC,GAC/BC,OAAOC,QAAQF,GACZG,OAAO,EAAEC,KAASA,EAAIC,QACtBC,QAAQ,EAAEF,EAAKG,KAAWR,EAAGS,UAAUC,OAAOL,EAAKG,GACvD,CAED,WAAwBR,EAAaW,GACnCX,EAAGY,iBAAiB,gBAAiBD,GACrCX,EAAGY,iBAAiB,eAAgBD,EACrC,CAED,SAAAE,EAA2Bb,EAAaW,GACtCX,EAAGc,oBAAoB,gBAAiBH,GACxCX,EAAGc,oBAAoB,eAAgBH,EACxC,CAED,SAAAI,EAAcf,EAAkBgB,EAAgB,IAAE,IAAAC,EAChD,KAAMjB,aAAFkB,aAA8B,OAElC,GAAIlB,EAAGS,UAAUU,SAAS,cACxB,OAEF,SAAAnB,EAAGoB,QAAHH,EAAUI,QAEI,eAAVL,IACFA,EAAQ,IAEV,MAAMM,EAAaC,IAAiB,IAAAC,GACzB,MAALD,SAAAA,EAAOE,UAAWzB,IAEtBD,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdgB,CAACA,IAAQ,IAEX,OAAAQ,EAAAxB,EAAGoB,QAAHI,EAAUH,UAGGK,EAAGC,WAAWL,EAAW,KAExCtB,EAAGoB,MAAQ,CACTC,MAAO,KACLR,EAAkBb,EAAIsB,GACtBM,aAAaF,GACb3B,EAAWC,EAAI,CAAEgB,CAACA,IAAQ,MAI9Ba,EAAe7B,EAAIsB,GAEnBvB,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdgB,CAACA,IAAQ,IAGXW,WAAW,IAAM5B,EAAWC,EAAI,CAC9B,WAAW,EACX,cAAc,EACd,cAAc,EACdgB,CAACA,IAAQ,IAEZ,CAED,SAASc,EAAK9B,EAAkBgB,EAAgB,IAC9C,IAAAe,EAAA,KAAM/B,aAAckB,aAAc,OAElC,GAAIlB,EAAGS,UAAUU,SAAS,gBAAkBnB,EAAGS,UAAUU,SAAS,WAChE,OAEF,OAAAY,EAAA/B,EAAGoB,QAAHW,EAAUV,QAEI,eAAVL,IACFA,EAAQ,IAEV,MAAeM,EAAIC,IACjB,IAAAS,GAAI,MAAAT,OAAA,EAAAA,EAAOE,UAAWzB,IAEtBD,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdgB,CAACA,IAAQ,IAEDK,OAAVrB,EAAAA,EAAGoB,QAAOC,EAAAA,QACX,EAEcK,EAAGC,WAAWL,EAAW,KAExCtB,EAAGoB,MAAQ,CACTC,MAAO,KACLR,EAAkBb,EAAIsB,GACtBM,aAAaF,GACb3B,EAAWC,EAAI,CAAEgB,CAACA,IAAQ,GAC3B,GAGHa,EAAe7B,EAAIsB,GAEnBvB,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdgB,CAACA,IAAQ,GAEZ,CAiBD,IAAAI,EAAe,CACbL,OACAe,OACApB,OAlBF,SAAgBV,EAAkBiC,EAAiBC,EAAuB,GAAIC,EAAuB,IAC7FnC,aAAFkB,mBAEiB,IAAjBe,EACEjC,EAAGS,UAAUU,SAAS,cACxBW,EAAK9B,EAAImC,GAETpB,EAAKf,EAAIkC,GAGPD,EAAOlB,EAAKf,EAAIkC,GACfJ,EAAK9B,EAAImC,GAEjB"}