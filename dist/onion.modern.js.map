{"version":3,"file":"onion.modern.js","sources":["../src/onion.ts"],"sourcesContent":["interface OnionElement extends HTMLElement {\n  onion?: {\n    abort: () => void;\n  }\n}\n\ninterface ClassList {\n  [key: string]: boolean;\n}\n\nfunction setClasses(el: Element, classes: ClassList) {\n  Object.entries(classes).forEach(([key, value]) => el.classList.toggle(key, value));\n}\n\nfunction addEndListener(el: Element, listener: () => void) {\n  el.addEventListener(\"transitionend\", listener);\n  el.addEventListener(\"animationend\", listener);\n}\n\nfunction removeEndListener(el: Element, listener: () => void) {\n  el.removeEventListener(\"transitionend\", listener);\n  el.removeEventListener(\"animationend\", listener);\n}\n\nexport function show(el: OnionElement) {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-open\") && !el.classList.contains(\"is-closing\"))\n    return;\n\n  el.onion?.abort();\n\n  const handleEnd = () => {\n    setClasses(el, {\n      'is-open': true,\n      'is-closed': false,\n      'is-opening': false,\n      'is-closing': false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    'is-open': false,\n    'is-closed': false,\n    'is-opening': false,\n    'is-closing': false,\n  });\n\n  setTimeout(() => {\n    setClasses(el, {\n      'is-open': true,\n      'is-closed': false,\n      'is-opening': true,\n      'is-closing': false,\n    });\n  });\n}\n\nexport function hide(el: OnionElement) {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-closed\"))\n    return;\n\n  el.onion?.abort();\n\n  const handleEnd = () => {\n    setClasses(el, {\n      'is-open': false,\n      'is-closed': true,\n      'is-opening': false,\n      'is-closing': false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    'is-open': true,\n    'is-closed': false,\n    'is-opening': false,\n    'is-closing': true,\n  });\n}\n\nexport function toggle(el: OnionElement, force?: boolean) {\n  if (!(el instanceof HTMLElement)) return;\n\n  el.onion?.abort();\n\n  if (typeof force === 'undefined') {\n    if (el.classList.contains('is-open') && !el.classList.contains(\"is-closing\")) {\n      hide(el);\n    } else {\n      show(el);\n    }\n  } else {\n    if (force) show(el);\n    else hide(el);\n  }\n}\n"],"names":["setClasses","el","classes","Object","entries","forEach","key","value","classList","toggle","addEndListener","listener","addEventListener","removeEndListener","removeEventListener","show","_el$onion","HTMLElement","contains","onion","abort","handleEnd","_el$onion2","timeoutID","setTimeout","clearTimeout","hide","_el$onion3","_el$onion4","force","_el$onion5"],"mappings":"AAUA,SAASA,EAAWC,EAAaC,GAC/BC,OAAOC,QAAQF,GAASG,QAAQ,EAAEC,EAAKC,KAAWN,EAAGO,UAAUC,OAAOH,EAAKC,GAC5E,CAED,SAASG,EAAeT,EAAaU,GACnCV,EAAGW,iBAAiB,gBAAiBD,GACrCV,EAAGW,iBAAiB,eAAgBD,EACrC,CAED,SAASE,EAAkBZ,EAAaU,GACtCV,EAAGa,oBAAoB,gBAAiBH,GACxCV,EAAGa,oBAAoB,eAAgBH,EACxC,CAEeI,SAAAA,EAAKd,GACnB,IAAAe,EAAA,KAAMf,aAAcgB,aAAc,OAElC,GAAIhB,EAAGO,UAAUU,SAAS,aAAejB,EAAGO,UAAUU,SAAS,cAC7D,OAEF,OAAAF,EAAAf,EAAGkB,QAAHH,EAAUI,QAEV,MAAeC,EAAG,KAAK,IAAAC,EACrBtB,EAAWC,EAAI,CACb,WAAW,EACX,aAAa,EACb,cAAc,EACd,cAAc,IAEhB,OAAAA,EAAAA,EAAGkB,QAAHG,EAAUF,OACX,EAEcG,EAAGC,WAAWH,EAAW,KAExCpB,EAAGkB,MAAQ,CACTC,MAAO,KACLP,EAAkBZ,EAAIoB,GACtBI,aAAaF,EAAD,GAIhBb,EAAeT,EAAIoB,GAEnBrB,EAAWC,EAAI,CACb,WAAW,EACX,aAAa,EACb,cAAc,EACd,cAAc,IAGhBuB,WAAW,KACTxB,EAAWC,EAAI,CACb,WAAW,EACX,aAAa,EACb,cAAc,EACd,cAAc,GAJN,EAOb,UAEKyB,EAAezB,GACnB,IAAA0B,EAAA,KAAM1B,aAAFgB,aAA8B,OAElC,GAAIhB,EAAGO,UAAUU,SAAS,aACxB,OAEQE,OAAVO,EAAA1B,EAAGkB,QAAOC,EAAAA,QAEV,MAAeC,EAAG,KAChBrB,IAAAA,EAAAA,EAAWC,EAAI,CACb,WAAW,EACX,aAAa,EACb,cAAc,EACd,cAAc,IAEhB,SAAAA,EAAGkB,QAAHS,EAAUR,OACX,EAEcG,EAAGC,WAAWH,EAAW,KAExCpB,EAAGkB,MAAQ,CACTC,MAAO,KACLP,EAAkBZ,EAAIoB,GACtBI,aAAaF,EACd,GAGHb,EAAeT,EAAIoB,GAEnBrB,EAAWC,EAAI,CACb,WAAW,EACX,aAAa,EACb,cAAc,EACd,cAAc,GAEjB,CAEeQ,SAAAA,EAAOR,EAAkB4B,GACvC,IAAAC,EAAM7B,aAAFgB,cAEJ,SAAAhB,EAAGkB,QAAHW,EAAUV,aAEW,IAAVS,EACL5B,EAAGO,UAAUU,SAAS,aAAejB,EAAGO,UAAUU,SAAS,cAC7DQ,EAAKzB,GAELc,EAAKd,GAGH4B,EAAOd,EAAKd,GACPyB,EAACzB,GAEb"}