{"version":3,"file":"onion.modern.js","sources":["../src/onion.ts"],"sourcesContent":["interface OnionElement extends HTMLElement {\n  onion?: {\n    abort?: () => void;\n  }\n}\n\ninterface ClassList {\n  [key: string]: boolean;\n}\n\nfunction setClasses(el: Element, classes: ClassList) {\n  Object.entries(classes)\n    .filter(([key]) => key.length)\n    .forEach(([key, value]) => el.classList.toggle(key, value));\n}\n\nfunction addEndListener(el: Element, listener: () => void) {\n  el.addEventListener(\"transitionend\", listener);\n  el.addEventListener(\"animationend\", listener);\n}\n\nfunction removeEndListener(el: Element, listener: () => void) {\n  el.removeEventListener(\"transitionend\", listener);\n  el.removeEventListener(\"animationend\", listener);\n}\n\nfunction show(el: OnionElement, token: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-opening\"))\n    return;\n\n  el.onion?.abort?.();\n\n  if (token === \"is-opening\")\n    token = \"\";\n\n  const handleEnd = (event?: Event) => {\n    if (event && event.target !== el) return;\n\n    setClasses(el, {\n      \"is-open\": true,\n      \"is-opening\": true,\n      \"is-closing\": false,\n      [token]: false,\n    });\n    el.onion?.abort?.();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = Object.assign(el.onion || {}, {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n      setClasses(el, { [token]: false });\n      delete el.onion?.abort;\n    }\n  });\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": false,\n    \"is-closing\": false,\n    [token]: false,\n  });\n\n  setTimeout(() => setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": true,\n    \"is-closing\": false,\n    [token]: true,\n  }));\n}\n\nfunction hide(el: OnionElement, token: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-closing\") || !el.classList.contains(\"is-open\"))\n    return;\n\n  el.onion?.abort?.();\n\n  if (token === \"is-closing\")\n    token = \"\";\n\n  const handleEnd = (event?: Event) => {\n    if (event && event.target !== el) return;\n\n    setClasses(el, {\n      \"is-open\": false,\n      \"is-opening\": false,\n      \"is-closing\": false,\n      [token]: false,\n    });\n    el.onion?.abort?.();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = Object.assign(el.onion || {}, {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n      setClasses(el, { [token]: false });\n      delete el.onion?.abort;\n    }\n  });\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": false,\n    \"is-closing\": true,\n    [token]: true,\n  });\n}\n\nfunction toggle(el: OnionElement, force?: boolean, openingToken: string = \"\", closingToken: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (typeof force === 'undefined') {\n    if (el.classList.contains('is-opening')) {\n      hide(el, closingToken);\n    } else {\n      show(el, openingToken);\n    }\n  } else {\n    if (force) show(el, openingToken);\n    else hide(el, closingToken);\n  }\n}\n\nexport default {\n  show,\n  hide,\n  toggle\n};\n"],"names":["setClasses","el","classes","Object","entries","filter","key","length","forEach","value","classList","toggle","addEndListener","listener","addEventListener","removeEndListener","removeEventListener","token","_el$onion","HTMLElement","contains","onion","abort","event","_el$onion2","target","timeoutID","setTimeout","handleEnd","assign","clearTimeout","_el$onion3","hide","_el$onion4","_el$onion5","_el$onion6","show","force","openingToken","closingToken"],"mappings":"AAUA,SAAAA,EAAoBC,EAAaC,GAC/BC,OAAOC,QAAQF,GACZG,OAAO,EAAEC,KAASA,EAAIC,QACtBC,QAAQ,EAAEF,EAAKG,KAAWR,EAAGS,UAAUC,OAAOL,EAAKG,GACvD,CAED,SAAAG,EAAwBX,EAAaY,GACnCZ,EAAGa,iBAAiB,gBAAiBD,GACrCZ,EAAGa,iBAAiB,eAAgBD,EACrC,CAED,SAASE,EAAkBd,EAAaY,GACtCZ,EAAGe,oBAAoB,gBAAiBH,GACxCZ,EAAGe,oBAAoB,eAAgBH,EACxC,CAED,WAAcZ,EAAkBgB,EAAgB,IAC9C,IAAAC,EAAA,KAAMjB,aAAFkB,aAA8B,OAElC,GAAIlB,EAAGS,UAAUU,SAAS,cACxB,OAEF,SAAAnB,EAAGoB,QAAH,MAAAH,EAAUI,OAAVJ,EAAUI,QAEI,eAAVL,IACFA,EAAQ,IAEV,QAAmBM,IAAiB,IAAAC,EAC9BD,GAASA,EAAME,SAAWxB,IAE9BD,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdgB,CAACA,IAAQ,IAEDK,OAAVE,EAAAvB,EAAGoB,QAAOC,MAAAA,EAAAA,OAAAA,EAAAA,UAGNI,EAAYC,WAAWC,EAAW,KAExC3B,EAAGoB,MAAQlB,OAAO0B,OAAO5B,EAAGoB,OAAS,CAAA,EAAI,CACvCC,MAAO,KACLP,IAAAA,EAAAA,EAAkBd,EAAI2B,GACtBE,aAAaJ,GACb1B,EAAWC,EAAI,CAAEgB,CAACA,IAAQ,IACnB,OAAPc,EAAO9B,EAAGoB,eAAHU,EAAUT,KAAAA,IAIrBV,EAAeX,EAAI2B,GAEnB5B,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdgB,CAACA,IAAQ,IAGXU,WAAW,IAAM3B,EAAWC,EAAI,CAC9B,WAAW,EACX,cAAc,EACd,cAAc,EACdgB,CAACA,IAAQ,IAEZ,CAED,SAAAe,EAAc/B,EAAkBgB,EAAgB,IAAE,IAAAgB,EAChD,KAAMhC,aAAckB,aAAc,OAElC,GAAIlB,EAAGS,UAAUU,SAAS,gBAAkBnB,EAAGS,UAAUU,SAAS,WAChE,OAEF,OAAAnB,EAAAA,EAAGoB,QAAH,MAAAY,EAAUX,OAAVW,EAAUX,QAEI,eAAVL,IACFA,EAAQ,IAEV,MAAeW,EAAIL,IAAiB,IAAAW,EAC9BX,GAASA,EAAME,SAAWxB,IAE9BD,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdgB,CAACA,IAAQ,IAEDK,OAAVY,EAAAjC,EAAGoB,QAAOC,MAAAA,EAAAA,OAAAA,EAAAA,QAAV,IAGgBK,WAAWC,EAAW,KAExC3B,EAAGoB,MAAQlB,OAAO0B,OAAO5B,EAAGoB,OAAS,CAA1B,EAA8B,CACvCC,MAAO,KAAK,IAAAa,EACVpB,EAAkBd,EAAI2B,GACtBE,aAAaJ,GACb1B,EAAWC,EAAI,CAAEgB,CAACA,IAAQ,IACnB,OAAPkB,EAAOlC,EAAGoB,eAAHc,EAAUb,KAAAA,IAIrBV,EAAeX,EAAI2B,GAEnB5B,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdgB,CAACA,IAAQ,GAEZ,CAiBD,MAAe,CACbmB,OACAJ,OACArB,OAlBF,SAAgBV,EAAkBoC,EAAiBC,EAAuB,GAAIC,EAAuB,IAC7FtC,gCAEe,IAAVoC,EACLpC,EAAGS,UAAUU,SAAS,cACxBY,EAAK/B,EAAIsC,GAETH,EAAKnC,EAAIqC,GAGPD,EAAOD,EAAKnC,EAAIqC,GACXN,EAAC/B,EAAIsC,GAEjB"}