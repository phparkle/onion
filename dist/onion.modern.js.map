{"version":3,"file":"onion.modern.js","sources":["../src/onion.ts"],"sourcesContent":["interface OnionElement extends HTMLElement {\n  onion?: {\n    abort: () => void;\n  }\n}\n\ninterface ClassList {\n  [key: string]: boolean;\n}\n\nfunction setClasses(el: Element, classes: ClassList) {\n  Object.entries(classes)\n    .filter(([key]) => key.length)\n    .forEach(([key, value]) => el.classList.toggle(key, value));\n}\n\nfunction addEndListener(el: Element, listener: () => void) {\n  el.addEventListener(\"transitionend\", listener);\n  el.addEventListener(\"animationend\", listener);\n}\n\nfunction removeEndListener(el: Element, listener: () => void) {\n  el.removeEventListener(\"transitionend\", listener);\n  el.removeEventListener(\"animationend\", listener);\n}\n\nfunction show(el: OnionElement, token: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-opening\"))\n    return;\n\n  el.onion?.abort();\n\n  if (token === \"is-opening\")\n    token = \"\";\n\n  const handleEnd = () => {\n    setClasses(el, {\n      \"is-open\": true,\n      \"is-opening\": true,\n      \"is-closing\": false,\n      [token]: false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n      setClasses(el, { [token]: false });\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": false,\n    \"is-closing\": false,\n    [token]: false,\n  });\n\n  setTimeout(() => setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": true,\n    \"is-closing\": false,\n    [token]: true,\n  }));\n}\n\nfunction hide(el: OnionElement, token: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (el.classList.contains(\"is-closing\") || !el.classList.contains(\"is-open\"))\n    return;\n\n  el.onion?.abort();\n\n  if (token === \"is-closing\")\n    token = \"\";\n\n  const handleEnd = () => {\n    setClasses(el, {\n      \"is-open\": false,\n      \"is-opening\": false,\n      \"is-closing\": false,\n      [token]: false,\n    });\n    el.onion?.abort();\n  }\n\n  const timeoutID = setTimeout(handleEnd, 2000);\n\n  el.onion = {\n    abort: () => {\n      removeEndListener(el, handleEnd);\n      clearTimeout(timeoutID);\n      setClasses(el, { [token]: false });\n    }\n  }\n\n  addEndListener(el, handleEnd);\n\n  setClasses(el, {\n    \"is-open\": true,\n    \"is-opening\": false,\n    \"is-closing\": true,\n    [token]: true,\n  });\n}\n\nfunction toggle(el: OnionElement, force?: boolean, openingToken: string = \"\", closingToken: string = \"\") {\n  if (!(el instanceof HTMLElement)) return;\n\n  if (typeof force === 'undefined') {\n    if (el.classList.contains('is-opening')) {\n      hide(el, closingToken);\n    } else {\n      show(el, openingToken);\n    }\n  } else {\n    if (force) show(el, openingToken);\n    else hide(el, closingToken);\n  }\n}\n\nexport default {\n  show,\n  hide,\n  toggle\n};\n"],"names":["setClasses","el","classes","Object","entries","filter","key","length","forEach","value","classList","toggle","addEndListener","listener","addEventListener","removeEndListener","removeEventListener","show","token","_el$onion","HTMLElement","contains","onion","abort","handleEnd","_el$onion2","timeoutID","setTimeout","clearTimeout","hide","_el$onion3","_el$onion4","force","openingToken","closingToken"],"mappings":"AAUA,SAAAA,EAAoBC,EAAaC,GAC/BC,OAAOC,QAAQF,GACZG,OAAO,EAAEC,KAASA,EAAIC,QACtBC,QAAQ,EAAEF,EAAKG,KAAWR,EAAGS,UAAUC,OAAOL,EAAKG,GACvD,CAED,SAAAG,EAAwBX,EAAaY,GACnCZ,EAAGa,iBAAiB,gBAAiBD,GACrCZ,EAAGa,iBAAiB,eAAgBD,EACrC,CAED,SAAAE,EAA2Bd,EAAaY,GACtCZ,EAAGe,oBAAoB,gBAAiBH,GACxCZ,EAAGe,oBAAoB,eAAgBH,EACxC,CAED,SAAAI,EAAchB,EAAkBiB,EAAgB,IAC9C,IAAAC,EAAA,KAAMlB,aAAcmB,aAAc,OAElC,GAAInB,EAAGS,UAAUW,SAAS,cACxB,OAEF,OAAApB,EAAAA,EAAGqB,QAAHH,EAAUI,QAEI,eAAVL,IACFA,EAAQ,IAEV,MAAeM,EAAG,KAAK,IAAAC,EACrBzB,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdiB,CAACA,IAAQ,IAEDK,OAAVtB,EAAAA,EAAGqB,QAAOC,EAAAA,OACX,EAEcG,EAAGC,WAAWH,EAAW,KAExCvB,EAAGqB,MAAQ,CACTC,MAAO,KACLR,EAAkBd,EAAIuB,GACtBI,aAAaF,GACb1B,EAAWC,EAAI,CAAEiB,CAACA,IAAQ,GAC3B,GAGHN,EAAeX,EAAIuB,GAEnBxB,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdiB,CAACA,IAAQ,IAGXS,WAAW,IAAM3B,EAAWC,EAAI,CAC9B,WAAW,EACX,cAAc,EACd,cAAc,EACdiB,CAACA,IAAQ,IAEZ,CAED,SAASW,EAAK5B,EAAkBiB,EAAgB,IAAE,IAAAY,EAChD,KAAM7B,aAAFmB,aAA8B,OAElC,GAAInB,EAAGS,UAAUW,SAAS,gBAAkBpB,EAAGS,UAAUW,SAAS,WAChE,OAEQE,OAAVtB,EAAAA,EAAGqB,QAAOC,EAAAA,QAEI,eAAVL,IACFA,EAAQ,IAEV,MAAeM,EAAG,KAAK,IAAAO,EACrB/B,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdiB,CAACA,IAAQ,IAEDK,OAAVQ,EAAA9B,EAAGqB,QAAOC,EAAAA,OACX,EAEcG,EAAGC,WAAWH,EAAW,KAExCvB,EAAGqB,MAAQ,CACTC,MAAO,KACLR,EAAkBd,EAAIuB,GACtBI,aAAaF,GACb1B,EAAWC,EAAI,CAAEiB,CAACA,IAAQ,GAC3B,GAGHN,EAAeX,EAAIuB,GAEnBxB,EAAWC,EAAI,CACb,WAAW,EACX,cAAc,EACd,cAAc,EACdiB,CAACA,IAAQ,GAEZ,CAiBD,IAAAI,EAAe,CACbL,OACAY,OACAlB,OAlBF,SAAgBV,EAAkB+B,EAAiBC,EAAuB,GAAIC,EAAuB,IAC7FjC,gCAEe,IAAV+B,EACL/B,EAAGS,UAAUW,SAAS,cACxBQ,EAAK5B,EAAIiC,GAETjB,EAAKhB,EAAIgC,GAGPD,EAAOf,EAAKhB,EAAIgC,GACXJ,EAAC5B,EAAIiC,GAEjB"}